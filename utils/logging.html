<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>langbrainscore.utils.logging API documentation</title>
<meta name="description" content="Utility functions for logging to stdout and tracking parameters using Weights and Biases" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>langbrainscore.utils.logging</code></h1>
</header>
<section id="section-intro">
<p>Utility functions for logging to stdout and tracking parameters using Weights and Biases</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;Utility functions for logging to stdout and tracking parameters using Weights and Biases&#34;&#34;&#34;

################################################################
# stuff for type annotations
################################################################
import typing

# from langbrainscore.interface.cacheable import _Cacheable

################################################################
# stuff for logging to W&amp;B (https://wandb.ai)
################################################################


def init_wandb(project: str, group: str, use_wandb=True):
    &#34;&#34;&#34;Initializes an instance of Weights &amp; Biases for logging

    Args:
        project (str): a broad grouping of what project this wandb instance
            should be under, e.g., alpha testing, or human-predictive-processing-1
        group (str): a more immediate grouping, recommended: by benchmark
        use_wandb (bool, optional): if False, we will not initialize W&amp;B.
            Mainly for compatibility with CLI. Defaults to True.
    &#34;&#34;&#34;
    if use_wandb:
        import wandb

        wandb.init(
            project=project,
            entity=&#34;langbrainscore&#34;,
            # group=group,
        )


def log_to_wandb(
    *obs: typing.Collection[typing.Union[&#34;_Cacheable&#34;, dict]],
    use_wandb=True,
    commit=False,
):
    &#34;&#34;&#34;Given a `_Cacheable` object, logs its salient parameters to W&amp;B by
        prefixing them with class name.

    Args:
        ob (typing.Union[_Cacheable, typing.Mapping]): Object to log
        use_wandb (bool, optional): if False, we will not log anything. For compatibility with CLI.
            Defaults to True.
    &#34;&#34;&#34;
    if use_wandb:
        import wandb

        # if a singleton object is passed, we convert it to a collection
        try:
            iter(obs)
        except TypeError:
            obs = [obs]

        for ob in obs:
            if hasattr(ob, &#34;params&#34;):
                d = {f&#34;{ob.__class__.__name__}/{k}&#34;: v for k, v in ob.params.items()}
            else:
                d = ob
            wandb.log(d, commit=False)

        wandb.log({}, commit=commit)


################################################################
# stuff for logging to the terminal
################################################################
import textwrap
from datetime import date
from sys import stderr, stdout
from time import time
import shutil
import os

from colorama import Back, Fore, Style, init
from tqdm import tqdm


def verbose() -&gt; bool:
    &#34;&#34;&#34;returns True if env variable &#34;VERBOSE&#34; is set to 1&#34;&#34;&#34;
    return os.environ.get(&#34;VERBOSE&#34;, None) == &#34;1&#34;


init(autoreset=True)
_START_TIME = time()


def START_TIME():
    return _START_TIME


def log(message, cmap=&#34;INFO&#34;, type=None, verbosity_check=False, **kwargs):
    &#34;&#34;&#34;Utility function to log a `message` to stdout

    Args:
        message (typing.Any): an object that supports `__str__()`
        cmap (str, optional): what  colormap to use. &#34;INFO&#34; corresponds to blue,
            &#34;WARN&#34; Defaults to &#34;INFO&#34;.
        type (str, optional): Type of message, for user knowledge. If provided, will be used as the
            tag for this output (e.g. &#34;info&#34;).  If no value is provided, the same string as `cmap` is
            used as the tag. Defaults to None.
        verbosity_check (bool, optional): Whether to check for a &#34;VERBOSE&#34; environment flag before
            outputting.  If false, always output text regardless of verbosity setting. Defaults to False.
    &#34;&#34;&#34;
    if verbosity_check and not verbose():
        return

    _message = str(message)

    class T:
        HEADER = &#34;\033[95m&#34;
        OKBLUE = &#34;\033[94m&#34;
        OKCYAN = &#34;\033[96m&#34;
        OKGREEN = &#34;\033[92m&#34;
        WARNING = &#34;\033[93m&#34;
        FAIL = &#34;\033[91m&#34;
        ENDC = &#34;\033[0m&#34;
        BOLD = &#34;\033[1m&#34;
        UNDERLINE = &#34;\033[4m&#34;

    if cmap == &#34;INFO&#34;:
        c = T.OKBLUE
    elif cmap == &#34;WARN&#34;:
        c = T.BOLD + T.WARNING
    elif cmap == &#34;ANNOUNCE&#34;:
        c = T.BOLD + T.OKGREEN
    elif cmap == &#34;ERR&#34;:
        c = &#34;\n&#34; + T.BOLD + T.FAIL
    else:
        c = T.OKBLUE

    timestamp = f&#34;{time() - START_TIME():.2f}s&#34;
    lines = textwrap.wrap(
        _message + T.ENDC,
        width=shutil.get_terminal_size((120, 24))[0] - 1,
        initial_indent=c + &#34;%&#34; * 3 + f&#34; [{type or cmap.lower()} @ {timestamp}] &#34;,
        subsequent_indent=&#34;. &#34; * 6 + &#34;&#34;,
    )
    tqdm.write(&#34;\n&#34;.join(lines), file=stderr)
    # print(*lines, sep=&#39;\n&#39;, file=stderr)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="langbrainscore.utils.logging.START_TIME"><code class="name flex">
<span>def <span class="ident">START_TIME</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def START_TIME():
    return _START_TIME</code></pre>
</details>
</dd>
<dt id="langbrainscore.utils.logging.init_wandb"><code class="name flex">
<span>def <span class="ident">init_wandb</span></span>(<span>project: str, group: str, use_wandb=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Initializes an instance of Weights &amp; Biases for logging</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>project</code></strong> :&ensp;<code>str</code></dt>
<dd>a broad grouping of what project this wandb instance
should be under, e.g., alpha testing, or human-predictive-processing-1</dd>
<dt><strong><code>group</code></strong> :&ensp;<code>str</code></dt>
<dd>a more immediate grouping, recommended: by benchmark</dd>
<dt><strong><code>use_wandb</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>if False, we will not initialize W&amp;B.
Mainly for compatibility with CLI. Defaults to True.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init_wandb(project: str, group: str, use_wandb=True):
    &#34;&#34;&#34;Initializes an instance of Weights &amp; Biases for logging

    Args:
        project (str): a broad grouping of what project this wandb instance
            should be under, e.g., alpha testing, or human-predictive-processing-1
        group (str): a more immediate grouping, recommended: by benchmark
        use_wandb (bool, optional): if False, we will not initialize W&amp;B.
            Mainly for compatibility with CLI. Defaults to True.
    &#34;&#34;&#34;
    if use_wandb:
        import wandb

        wandb.init(
            project=project,
            entity=&#34;langbrainscore&#34;,
            # group=group,
        )</code></pre>
</details>
</dd>
<dt id="langbrainscore.utils.logging.log"><code class="name flex">
<span>def <span class="ident">log</span></span>(<span>message, cmap='INFO', type=None, verbosity_check=False, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Utility function to log a <code>message</code> to stdout</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>message</code></strong> :&ensp;<code>typing.Any</code></dt>
<dd>an object that supports <code>__str__()</code></dd>
<dt><strong><code>cmap</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>what
colormap to use. "INFO" corresponds to blue,
"WARN" Defaults to "INFO".</dd>
<dt><strong><code>type</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Type of message, for user knowledge. If provided, will be used as the
tag for this output (e.g. "info").
If no value is provided, the same string as <code>cmap</code> is
used as the tag. Defaults to None.</dd>
<dt><strong><code>verbosity_check</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Whether to check for a "VERBOSE" environment flag before
outputting.
If false, always output text regardless of verbosity setting. Defaults to False.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def log(message, cmap=&#34;INFO&#34;, type=None, verbosity_check=False, **kwargs):
    &#34;&#34;&#34;Utility function to log a `message` to stdout

    Args:
        message (typing.Any): an object that supports `__str__()`
        cmap (str, optional): what  colormap to use. &#34;INFO&#34; corresponds to blue,
            &#34;WARN&#34; Defaults to &#34;INFO&#34;.
        type (str, optional): Type of message, for user knowledge. If provided, will be used as the
            tag for this output (e.g. &#34;info&#34;).  If no value is provided, the same string as `cmap` is
            used as the tag. Defaults to None.
        verbosity_check (bool, optional): Whether to check for a &#34;VERBOSE&#34; environment flag before
            outputting.  If false, always output text regardless of verbosity setting. Defaults to False.
    &#34;&#34;&#34;
    if verbosity_check and not verbose():
        return

    _message = str(message)

    class T:
        HEADER = &#34;\033[95m&#34;
        OKBLUE = &#34;\033[94m&#34;
        OKCYAN = &#34;\033[96m&#34;
        OKGREEN = &#34;\033[92m&#34;
        WARNING = &#34;\033[93m&#34;
        FAIL = &#34;\033[91m&#34;
        ENDC = &#34;\033[0m&#34;
        BOLD = &#34;\033[1m&#34;
        UNDERLINE = &#34;\033[4m&#34;

    if cmap == &#34;INFO&#34;:
        c = T.OKBLUE
    elif cmap == &#34;WARN&#34;:
        c = T.BOLD + T.WARNING
    elif cmap == &#34;ANNOUNCE&#34;:
        c = T.BOLD + T.OKGREEN
    elif cmap == &#34;ERR&#34;:
        c = &#34;\n&#34; + T.BOLD + T.FAIL
    else:
        c = T.OKBLUE

    timestamp = f&#34;{time() - START_TIME():.2f}s&#34;
    lines = textwrap.wrap(
        _message + T.ENDC,
        width=shutil.get_terminal_size((120, 24))[0] - 1,
        initial_indent=c + &#34;%&#34; * 3 + f&#34; [{type or cmap.lower()} @ {timestamp}] &#34;,
        subsequent_indent=&#34;. &#34; * 6 + &#34;&#34;,
    )
    tqdm.write(&#34;\n&#34;.join(lines), file=stderr)
    # print(*lines, sep=&#39;\n&#39;, file=stderr)</code></pre>
</details>
</dd>
<dt id="langbrainscore.utils.logging.log_to_wandb"><code class="name flex">
<span>def <span class="ident">log_to_wandb</span></span>(<span>*obs: Collection[Union[ForwardRef('_Cacheable'), dict]], use_wandb=True, commit=False)</span>
</code></dt>
<dd>
<div class="desc"><p>Given a <code>_Cacheable</code> object, logs its salient parameters to W&amp;B by
prefixing them with class name.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>ob</code></strong> :&ensp;<code>typing.Union[_Cacheable, typing.Mapping]</code></dt>
<dd>Object to log</dd>
<dt><strong><code>use_wandb</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>if False, we will not log anything. For compatibility with CLI.
Defaults to True.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def log_to_wandb(
    *obs: typing.Collection[typing.Union[&#34;_Cacheable&#34;, dict]],
    use_wandb=True,
    commit=False,
):
    &#34;&#34;&#34;Given a `_Cacheable` object, logs its salient parameters to W&amp;B by
        prefixing them with class name.

    Args:
        ob (typing.Union[_Cacheable, typing.Mapping]): Object to log
        use_wandb (bool, optional): if False, we will not log anything. For compatibility with CLI.
            Defaults to True.
    &#34;&#34;&#34;
    if use_wandb:
        import wandb

        # if a singleton object is passed, we convert it to a collection
        try:
            iter(obs)
        except TypeError:
            obs = [obs]

        for ob in obs:
            if hasattr(ob, &#34;params&#34;):
                d = {f&#34;{ob.__class__.__name__}/{k}&#34;: v for k, v in ob.params.items()}
            else:
                d = ob
            wandb.log(d, commit=False)

        wandb.log({}, commit=commit)</code></pre>
</details>
</dd>
<dt id="langbrainscore.utils.logging.verbose"><code class="name flex">
<span>def <span class="ident">verbose</span></span>(<span>) ‑> bool</span>
</code></dt>
<dd>
<div class="desc"><p>returns True if env variable "VERBOSE" is set to 1</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def verbose() -&gt; bool:
    &#34;&#34;&#34;returns True if env variable &#34;VERBOSE&#34; is set to 1&#34;&#34;&#34;
    return os.environ.get(&#34;VERBOSE&#34;, None) == &#34;1&#34;</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="langbrainscore.utils" href="index.html">langbrainscore.utils</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="langbrainscore.utils.logging.START_TIME" href="#langbrainscore.utils.logging.START_TIME">START_TIME</a></code></li>
<li><code><a title="langbrainscore.utils.logging.init_wandb" href="#langbrainscore.utils.logging.init_wandb">init_wandb</a></code></li>
<li><code><a title="langbrainscore.utils.logging.log" href="#langbrainscore.utils.logging.log">log</a></code></li>
<li><code><a title="langbrainscore.utils.logging.log_to_wandb" href="#langbrainscore.utils.logging.log_to_wandb">log_to_wandb</a></code></li>
<li><code><a title="langbrainscore.utils.logging.verbose" href="#langbrainscore.utils.logging.verbose">verbose</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>